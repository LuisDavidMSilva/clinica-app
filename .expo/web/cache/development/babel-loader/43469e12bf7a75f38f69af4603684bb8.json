{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useEffect, useRef, useState } from 'react';\nimport Animated from \"react-native-web/dist/exports/Animated\";\nimport useWindowDimensions from \"react-native-web/dist/exports/useWindowDimensions\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Surface from \"./Surface\";\nimport { useStyles } from \"./hooks/use-styles\";\n\nvar Backdrop = function Backdrop(_ref) {\n  var _ref$revealed = _ref.revealed,\n      revealed = _ref$revealed === void 0 ? false : _ref$revealed,\n      header = _ref.header,\n      headerHeight = _ref.headerHeight,\n      backLayer = _ref.backLayer,\n      backLayerHeight = _ref.backLayerHeight,\n      subheader = _ref.subheader,\n      subheaderHeight = _ref.subheaderHeight,\n      style = _ref.style,\n      headerContainerStyle = _ref.headerContainerStyle,\n      backLayerContainerStyle = _ref.backLayerContainerStyle,\n      frontLayerContainerStyle = _ref.frontLayerContainerStyle,\n      subheaderContainerStyle = _ref.subheaderContainerStyle,\n      children = _ref.children;\n\n  var _useState = useState(headerHeight !== null && headerHeight !== void 0 ? headerHeight : 0),\n      _useState2 = _slicedToArray(_useState, 2),\n      currentHeaderHeight = _useState2[0],\n      setCurrentHeaderHeight = _useState2[1];\n\n  var _useState3 = useState(backLayerHeight !== null && backLayerHeight !== void 0 ? backLayerHeight : 0),\n      _useState4 = _slicedToArray(_useState3, 2),\n      currentBackLayerHeight = _useState4[0],\n      setCurrentBackLayerHeight = _useState4[1];\n\n  var _useState5 = useState(subheaderHeight !== null && subheaderHeight !== void 0 ? subheaderHeight : 0),\n      _useState6 = _slicedToArray(_useState5, 2),\n      currentSubheaderHeight = _useState6[0],\n      setCurrentSubheaderHeight = _useState6[1];\n\n  var styles = useStyles(function (_ref2) {\n    var palette = _ref2.palette;\n    return {\n      container: {\n        flex: 1,\n        backgroundColor: palette.primary.main,\n        overflow: 'hidden'\n      },\n      frontLayer: {\n        position: 'absolute',\n        start: 0,\n        end: 0,\n        bottom: 0,\n        backgroundColor: palette.surface.main,\n        borderTopStartRadius: 16,\n        borderTopEndRadius: 16,\n        borderBottomStartRadius: 0,\n        borderBottomEndRadius: 0,\n        elevation: 1\n      }\n    };\n  });\n  var animated = useRef(new Animated.Value(revealed ? 1 : 0)).current;\n  useEffect(function () {\n    Animated.timing(animated, {\n      toValue: revealed ? 1 : 0,\n      duration: 300,\n      useNativeDriver: true\n    }).start();\n  }, [revealed]);\n  var dimensions = useWindowDimensions();\n  var translateY = animated.interpolate({\n    inputRange: [0, 1],\n    outputRange: [0, dimensions.height < currentHeaderHeight + currentBackLayerHeight ? dimensions.height - currentHeaderHeight - currentSubheaderHeight : currentBackLayerHeight]\n  });\n  return React.createElement(View, {\n    style: [styles.container, style]\n  }, React.createElement(View, {\n    style: [headerContainerStyle, {\n      height: headerHeight\n    }],\n    onLayout: function onLayout(e) {\n      if (!headerHeight) setCurrentHeaderHeight(e.nativeEvent.layout.height);\n    }\n  }, header), React.createElement(View, {\n    style: [backLayerContainerStyle, {\n      height: backLayerHeight\n    }],\n    onLayout: function onLayout(e) {\n      if (!backLayerHeight) setCurrentBackLayerHeight(e.nativeEvent.layout.height);\n    }\n  }, backLayer), React.createElement(Surface, {\n    style: [styles.frontLayer, {\n      top: currentHeaderHeight,\n      transform: [{\n        translateY: translateY\n      }]\n    }, frontLayerContainerStyle]\n  }, subheader && React.createElement(View, {\n    style: [subheaderContainerStyle, {\n      height: subheaderHeight\n    }],\n    onLayout: function onLayout(e) {\n      if (!subheaderHeight) setCurrentSubheaderHeight(e.nativeEvent.layout.height);\n    }\n  }, subheader), children));\n};\n\nexport default Backdrop;","map":{"version":3,"sources":["Backdrop.tsx"],"names":["Backdrop","revealed","children","useState","headerHeight","backLayerHeight","subheaderHeight","styles","useStyles","palette","container","flex","backgroundColor","overflow","frontLayer","position","start","end","bottom","borderTopStartRadius","borderTopEndRadius","borderBottomStartRadius","borderBottomEndRadius","elevation","animated","useRef","Animated","useEffect","toValue","duration","useNativeDriver","dimensions","useWindowDimensions","translateY","inputRange","outputRange","currentHeaderHeight","height","e","setCurrentHeaderHeight","setCurrentBackLayerHeight","top","transform","subheader","setCurrentSubheaderHeight"],"mappings":"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","sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\nimport { Animated, StyleProp, useWindowDimensions, View, ViewProps, ViewStyle } from 'react-native';\nimport Surface from './Surface';\nimport { useStyles } from './hooks/use-styles';\n\nexport interface BackdropProps {\n  revealed?: boolean;\n\n  header?: React.ReactElement | null;\n\n  headerHeight?: number;\n\n  backLayer?: React.ReactElement | null;\n\n  backLayerHeight?: number;\n\n  subheader?: React.ReactElement | null;\n\n  subheaderHeight?: number;\n\n  style?: StyleProp<ViewStyle>;\n\n  headerContainerStyle?: StyleProp<ViewStyle>;\n\n  backLayerContainerStyle?: StyleProp<ViewStyle>;\n\n  frontLayerContainerStyle?: Animated.AnimatedProps<ViewProps>['style'];\n\n  subheaderContainerStyle?: StyleProp<ViewStyle>;\n}\n\nconst Backdrop: React.FC<BackdropProps> = ({\n  revealed = false,\n  header,\n  headerHeight,\n  backLayer,\n  backLayerHeight,\n  subheader,\n  subheaderHeight,\n  style,\n  headerContainerStyle,\n  backLayerContainerStyle,\n  frontLayerContainerStyle,\n  subheaderContainerStyle,\n  children,\n}) => {\n  const [currentHeaderHeight, setCurrentHeaderHeight] = useState(headerHeight ?? 0);\n  const [currentBackLayerHeight, setCurrentBackLayerHeight] = useState(backLayerHeight ?? 0);\n  const [currentSubheaderHeight, setCurrentSubheaderHeight] = useState(subheaderHeight ?? 0);\n\n  const styles = useStyles(({ palette }) => ({\n    container: {\n      flex: 1,\n      backgroundColor: palette.primary.main,\n      overflow: 'hidden',\n    },\n    frontLayer: {\n      position: 'absolute',\n      start: 0,\n      end: 0,\n      bottom: 0,\n      backgroundColor: palette.surface.main,\n      borderTopStartRadius: 16,\n      borderTopEndRadius: 16,\n      borderBottomStartRadius: 0,\n      borderBottomEndRadius: 0,\n      elevation: 1,\n    },\n  }));\n\n  const animated = useRef(new Animated.Value(revealed ? 1 : 0)).current;\n\n  useEffect(() => {\n    Animated.timing(animated, {\n      toValue: revealed ? 1 : 0,\n      duration: 300,\n      useNativeDriver: true,\n    }).start();\n  }, [revealed]);\n\n  const dimensions = useWindowDimensions();\n\n  const translateY = animated.interpolate({\n    inputRange: [0, 1],\n    outputRange: [\n      0,\n      dimensions.height < currentHeaderHeight + currentBackLayerHeight\n        ? dimensions.height - currentHeaderHeight - currentSubheaderHeight\n        : currentBackLayerHeight,\n    ],\n  });\n\n  return (\n    <View style={[styles.container, style]}>\n      <View\n        style={[headerContainerStyle, { height: headerHeight }]}\n        onLayout={(e) => {\n          if (!headerHeight) setCurrentHeaderHeight(e.nativeEvent.layout.height);\n        }}\n      >\n        {header}\n      </View>\n\n      <View\n        style={[backLayerContainerStyle, { height: backLayerHeight }]}\n        onLayout={(e) => {\n          if (!backLayerHeight) setCurrentBackLayerHeight(e.nativeEvent.layout.height);\n        }}\n      >\n        {backLayer}\n      </View>\n\n      <Surface\n        style={[styles.frontLayer, { top: currentHeaderHeight, transform: [{ translateY }] }, frontLayerContainerStyle]}\n      >\n        {subheader && (\n          <View\n            style={[subheaderContainerStyle, { height: subheaderHeight }]}\n            onLayout={(e) => {\n              if (!subheaderHeight) setCurrentSubheaderHeight(e.nativeEvent.layout.height);\n            }}\n          >\n            {subheader}\n          </View>\n        )}\n\n        {children}\n      </Surface>\n    </View>\n  );\n};\n\nexport default Backdrop;\n"]},"metadata":{},"sourceType":"module"}